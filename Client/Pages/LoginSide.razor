@page "/login"
@using Milj√∏Festivalv2.Shared
@using System.Net.Http.Json
@using Client.Services
@using System.Globalization

@inject NavigationManager NavManager
@inject HttpClient Http

<head>
    <link href="/login.css" rel="stylesheet" />
</head>


<h3>Login</h3>
<div class="centerpage">
    <div class="container">
        <div class="form-container">
            <div>
                <label>Email:  </label>
                <input type="email" @bind="Bruger.brugernavn" />
            </div>
            <div>
                <label>Password:</label>
                <input type="password" @bind="Bruger.password" />
            </div>
            <button @onclick="Login">Login</button>
            <button @onclick="Register">Register</button>
        </div>
    </div>
</div>



@code {
    Bruger Bruger = new();

    [Inject]
    public IBrugerService BrugerService { get; set; }

    private async Task Login()
    {
        var loggedInBruger = await BrugerService.Login(Bruger);

        if (loggedInBruger != null)
        {
            // If the role of the user is "koordinator", redirect to koordinator dashboard
            if (loggedInBruger.rolle == "koordinator")
            {
                NavManager.NavigateTo("/koordinator");
            }
            // If the role of the user is "frivillig", redirect to frivillig dashboard
            else if (loggedInBruger.rolle == "frivillig")
            {
                NavManager.NavigateTo("/frivillig");
            }
        }
        else
        {
            Console.WriteLine("Login fejlede");
        }
    }

    private void Register()
    {
        NavManager.NavigateTo("/register");
    }

}
