<style>
    body {
        background-color: #315d55;
    }
</style>



@page "/register"
@using MiljøFestivalv2.Shared
@using System.Net.Http.Json
@using Client.Services
@using Microsoft.AspNetCore.Components.Forms
@using System.Globalization
@inject NavigationManager NavManager
@inject HttpClient Http

<h3>Register</h3>

<EditForm EditContext="@bEditContext" class="row p-3" OnValidSubmit="@HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />
<div class="container">
    <div>
        <!--&zwnj; betyder usynligt mellem (specielt tegn i html)-->
        <label>&zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; 
            Fulde Navn:</label>
        <InputText id="fulde_navn" @bind-Value="bruger.fulde_navn" required />
    </div>
    <div>
        <label>&zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj;
            Email:</label>
        <InputText id ="email" @bind-Value="bruger.email" required />
    </div>
    <div>
        <label>Telefonnummer:</label>
        <InputNumber id ="telefon_nummer" @bind-Value="bruger.telefon_nummer" required />
    </div>
    <div>
        <label> &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj;
            Fødselsdag:</label>
        <InputDate id="fødseldag" @bind-Value="bruger.fødselsdag" required />
    </div>
    <div>
        <label> &zwnj; &zwnj; &zwnj; &zwnj;
            CPR-nummer:</label>
        <InputText id ="cpr_number" @bind-Value="bruger.cpr_nummer" required />
    </div>
    <div>
        <label> &zwnj; &zwnj;&zwnj;&zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj;
            Brugernavn:</label>
        <InputText id ="brugernavn" @bind-Value="bruger.brugernavn" required />
    </div>
    <div>
        <label> &zwnj; &zwnj;&zwnj; &zwnj;&zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj; &zwnj;
            Password:</label>
        <InputText id ="password" @bind-Value="bruger.password" required />
    </div>
    <button type="submit">Register</button>
    <button @onclick="BackToLogin">Back to Login</button>
</div>
</EditForm>

@code {
    private EditContext bEditContext;
    Bruger bruger = new Bruger();
    
    [Inject]
    public IBrugerService BrugerService {get; set;}

    protected override void OnInitialized()
    {   
        bEditContext = new EditContext(bruger);
    }

    private async Task HandleValidSubmit()
    {
        await BrugerService.TilføjBruger(bruger);
        NavManager.NavigateTo("/confirmation");
    }

    private void HåndterFødselsdag(DateOnly NyDato)
    {
        bruger.fødselsdag = NyDato.ToDateTime(TimeOnly.MinValue);
    }

    private void BackToLogin()
    {
        NavManager.NavigateTo("/login");
    }
}
