@page "/koordinator"
@using MiljøFestivalv2.Shared
@using System.Net.Http.Json
@using Client.Services
@using System.Globalization
@inject HttpClient Http

<h1>Koordinator</h1>

@if (VagtListe == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <!-- Printer alle Frivillige ud-->
<h1 class="mb-3 mt-3">Alle Frivillige</h1>
 
<table class="table table-striped">
    <thead>
        <tr>
            <th>fulde navn</th>
            <th>email</th>
            <th>telefon nummer</th>
            <th>fødselsdag</th>
            <th>cpr nummer</th>
            <th>aktiv</th>
            <th>blacklistet</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var frivillige in FrivilligListe)
        {
            <tr>
                <td>@frivillige.fulde_navn</td>
                <td>@frivillige.email</td>
                <td>@frivillige.telefon_nummer</td>
                <td>@frivillige.fødselsdag</td>
                <td>@frivillige.cpr_nummer</td>
                
                @if (frivillige.er_aktiv)
                    {
                        <td> Ja </td>
                    } else 
                    {
                        <td> Nej </td>
                    }
                   
                @if (frivillige.er_blacklistet)
                    {
                        <td> Ja </td>
                    } else 
                    {
                        <td> Nej </td>
                    }

            </tr>
        }
    </tbody>
</table>

<!-- Printer alle vagter ud-->
<h1 class="mb-3 mt-3">Alle Vagter</h1>

<table class="table table-striped">
    <thead>
        <tr>
            
            <th>Område</th>
            <th>Antal Personer</th>
            <th>Beskrivelse</th>
            <th>Start Tid</th>
            <th>Slut tid</th>
            <th>Prioritering</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var vagt in VagtListe)
        {
            <tr>
                <td>@vagt.område</td>
                <td>@vagt.antal_personer</td>
                <td>@vagt.beskrivelse</td>
                <td>@vagt.start_tid</td>
                <td>@vagt.slut_tid</td>
                <td>@vagt.priotering</td>
            </tr>
        }
    </tbody>
</table>

}

@code {
    // Henter alle vagter
    public List<Vagt> VagtListe = new List<Vagt>();

    [Inject]
    public IVagtService Service { get; set; }

    // Henter alle brugere og på initialized henter vagter og brugere
    public List<Bruger> FrivilligListe = new List<Bruger>();

    [Inject]
    public IBrugerService ServiceBruger { get; set; }

    protected override async Task OnInitializedAsync()
    {
        FrivilligListe = (await ServiceBruger.HentAlleFrivillige()).ToList();
        VagtListe = (await Service.HentAlleVagter()).ToList();
    }

}

